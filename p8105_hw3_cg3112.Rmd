---
title: "HW3"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
devtools::install_github("p8105/p8105.datasets")

getwd()
```


Problem 1 Descibing the data set
```{r}
library(p8105.datasets)
data("instacart")
aisles <- instacart %>%
  select(aisle_id) %>%
  unique() %>%
  nrow() 

skimr::skim(instacart)

pop_aisle <- instacart %>%
 group_by(aisle_id) %>%
  summarize(
    items = n()
   )

most <- pop_aisle %>%
  filter(items == max(items))


```
This data set has `r nrow(instacart)` rows with 13 different variable names. There are 0 missing data. We can see from the skimr that the peak order hours are normally distributed around the middle of the day, and most orders occur on the beginning and end of the week.
There are `r aisles` individual isles.
The aisle with the most products is aisle 83 with 150609 different items.

```{r}
aisless <- instacart %>%
  group_by(aisle) %>%
  summarize(
    items = n()
  ) %>%
  filter(items > 10000) %>%
  ggplot(aes(x = aisle, y = items)) +
      geom_point() + 
       ylim(0,140000) +
       theme(axis.text.x = element_text(size = 7, angle = 45, hjust = 1))
  
  
  
 # summarize(prod_count = count("product_name")) %>%
  #filter(prod_count > 10000) %>%
  #ggplot(aes( x = aisle, y = product_name)) +
   #        geom_point() +
    #       theme(legend.position = "bottom")
```


##Question 2

Part 1
```{r}
data("brfss_smart2010")
brfss <- brfss_smart2010 %>%
   janitor::clean_names() %>%
   filter(topic == "Overall Health") %>%
   mutate(response = as.factor(response)) %>%
   mutate(response = factor(response,
     levels(response)[c(4,2,3,5,1)]))

states_2002 <- brfss %>%
  filter(year == 2002) %>%
  group_by(locationabbr) %>%
  distinct(locationdesc) %>%
  summarize(n = n()) %>%
  filter(n >= 7)

states_2010 <- brfss %>%
  filter(year == 2010) %>%
  group_by(locationabbr) %>%
  distinct(locationdesc) %>%
  summarize(n = n()) %>%
  filter(n >= 7)
  
```
These states listed below have more than seven locations in 2002:
`r states_2002$locationabbr`
and in 2010 these states had more than seven locations:
`r states_2010$locationabbr`

Part 2
```{r}
brfss %>%
  filter(response == "Excellent") %>%
  group_by(year, locationabbr) %>%
  summarize(dat = mean(data_value)) %>%
  ggplot(aes(x = year, y = dat, color = locationabbr)) +
     geom_line()
```

A two panel plot
```{r}
brfss %>%
  filter(year == c(2006,2010)) %>%
  filter(locationabbr == "NY") %>%
  ggplot(aes(x = response, y = data_value)) +
  geom_violin(aes(fill = response), color = "blue", alpha = .5) +
  stat_summary(fun.y = median, geom = "point", color = "blue", size = 4) +
  facet_grid(. ~ year)
  
  
```

Question 3
```{r}
accel <- read_csv("./accel_data.csv") %>%
  janitor::clean_names() %>%
  pivot_longer(
    activity_1:activity_1440,
    names_to = "activity",
    values_to = "activity_counts"
  ) %>%
    mutate(day = as_factor(day))  %>%
    mutate(day = factor(day,
      levels(day)[c(2,6,7,5,1,3,4)])) %>%
    mutate(end_1 = ifelse(day == ("Sunday") | day == ("Saturday"), 1,  0)) 
                    
 
levels(accel$day)
     
table(accel$day)
names(accel)
str(accel)

```
At this point we have 6 different variables
`r names(accel) `
There doesn't seem to be a reason to change the variable types (besides day) in the data frame:
week, day_id, activity_counts, and end_1 are all numeric while activity is character, and day is a factor.
There are `r nrow(accel)` observations. 

Part 2
```{r}
accel_day <- accel %>%
  group_by(day) %>%
  summarize(active = mean(activity_counts))
```

Plotting a 24-hr window
```{r}
accel_day %>%
  
```


